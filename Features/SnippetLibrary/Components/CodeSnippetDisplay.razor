@inherits FluxorComponent

@inject IJSRuntime JSRuntime
@inject IDispatcher Dispatcher

<MudPaper Class="mb-6 pa-3" Elevation="6">
    <MudText Typo="Typo.h6" Class="d-flex justify-space-between flex-grow-1">
        <span>@Snippet.Label</span>
        <span>
            @if (!string.IsNullOrEmpty(Snippet.SourceUrl))
            {
                <MudLink Href="@(Snippet.SourceUrl)" Target="_blank" Class="mr-3" title="Source Link">
                    <MudIcon Icon="@Icons.Filled.Link" Color="Color.Default" ViewBox="0 -6 24 24" />
                </MudLink>
            }
            <MudIconButton OnClick="CopyToClipboard" Variant="Variant.Text" Icon="@Icons.Material.Filled.ContentPaste" Title="Copy to Clipboard" Class="mx-1" />
        </span>
    </MudText>
    <MudElement Class="rounded-lg">
        <pre>
        <code class="@Snippet.Language">
                @Snippet.Content
            </code>
        </pre>
    </MudElement>
</MudPaper>

@code {

    [Parameter]
    public CodeSnippet Snippet { get; set; }

    private async Task CopyToClipboard()
    {
        await JSRuntime.InvokeVoidAsync("navigator.clipboard.writeText", Snippet.Content);
        Dispatcher.Dispatch(new SnackbarShowInfoAction($"{Snippet.Label} copied to clipboard"));
    }
}
